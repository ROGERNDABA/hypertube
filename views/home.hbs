<!-- Font Awesome -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://twitter.github.io/typeahead.js/js/handlebars.js"></script>
<link rel='stylesheet prefetch' href='https://fonts.googleapis.com/icon?family=Material+Icons'>
<link rel="stylesheet" href="/stylesheets/home.css">
<nav class="navbar navbar-toggleable-md navbar-light bg-faded">
	<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
		<span class="navbar-toggler-icon"></span>
	</button>
	<a class="navbar-brand" href="/home"><img src="/images/logo.png" width="30" height="30" class="d-inline-block align-top" alt=""></a>
	<div class="collapse navbar-collapse" id="navbarNav">
		<ul class="navbar-nav">
			<li class="nav-item active">
				<a class="nav-link" href="#">home<span class="sr-only">(current)</span></a>
			</li>
		</ul>
		<ul class="navbar-nav">
			<li class="nav-item active">
				<a class="nav-link" href="/video">video<span class="sr-only">(current)</span></a>
			</li>
		</ul>
	</div>
</nav>
<div class="container">
	<form id="search_form" action="/movie/search" method="POST">
		<div class="row">
			<div class="col-sm-9 col-md-7 col-lg-5 mx-auto">
				<div class="input-group">
					<input type="text" class="form-control" placeholder="Search" id="search" name="search" autofocus {{#if search}} value="{{search}}" {{/if}} />
					<div class="input-group-btn">
						<button class="btn btn-primary" type="submit">
							<i class="fab fa-search"></i>
						</button>
					</div>
				</div>
			</div>
		</div>
	</form>
</div>

<div class="containers">
	<div class="gala">
	</div>
</div>
<div class="movie-desc">
	<div class="box">
		<div class="cancel">
			<img style="width:100%;height:100%" src="/images/cancel.svg" id="cancel">
		</div>
	</div>
	<p></p>
</div>

<div class='player'>
	<center>
		<video id="videoPlayer" controls autoplay>
			<source src="http://localhost:8080/video" type="video/mp4" >
  			Your browser does not support the video tag.
		</video>
	</center>
</div>

</script>
<!--container-->

<script>
	function makeMovieCall() {
		var data = {};
		$.ajax({
			type: 'POST',
			data: JSON.stringify(data),
			contentType: 'application/json',
			url: '/movie/default',
			success: function(res) {
				// console.log(res);
				$('.gala').html(res);
			}
		});
	}

	function func(e) {
		var year = $(e).find($('.year')).html(),
			title = $(e).find($('.movie-title')).html();
		var data = {};
		data.title = title;

		var data;
		$.ajax({
			type: 'POST',
			data: JSON.stringify(data),
			contentType: 'application/json',
			url: '/movie/info',
			success: function(res) {
				console.log(res);
				$('.box').css({
					'background-image': 'url("https://image.tmdb.org/t/p/w500' + res.backdrop_path + '")'
				})
			}
		});

		// console.log(data);
		$('.movie-desc').css({
			'width': '70vw',
			'height': '800px'
		});
	}

	$('document').ready(function() {
		makeMovieCall();

		$('#cancel').on('click', function() {
			$('.movie-desc').css({
				'width': '0',
				'height': '0'
			});
		})

		document.getElementById("search").addEventListener("input", function() {
			if ($('#search').val() === '') {
				makeMovieCall();
			} else {
				var data = {};
				data.search = $('#search').val();
				$.ajax({
					type: 'POST',
					data: JSON.stringify(data),
					contentType: 'application/json',
					url: '/movie/search',
					success: function(res) {
						// console.log(res);
						$('.gala').html(res);
					}
				});
			}
		});
	});
</script>